import{x as j,r,l as z,o as O,m as Y,b as v,c as h,d as _,e as o,f as t,g as i,i as m,t as p,n as D,k as g}from"./index-96009e84.js";import{a as w}from"./axios-9cbf0d09.js";const K={class:"grid"},G={class:"col-12"},H={class:"card"},J={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},Q=o("h5",{class:"m-0"},"Manage Clients",-1),W={class:"block mt-2 md:mt-0 p-input-icon-left"},X=o("i",{class:"pi pi-search"},null,-1),Z=o("span",{class:"p-column-title"},"ID",-1),ee=o("span",{class:"p-column-title"},"Nom",-1),le=o("span",{class:"p-column-title"},"Prénom",-1),te=o("span",{class:"p-column-title"},"Adresse",-1),oe=o("span",{class:"p-column-title"},"Téléphone",-1),se=o("span",{class:"p-column-title"},"Sexe",-1),ae={class:"field"},ie=o("label",{for:"nom"},"Nom",-1),ne={key:0,class:"p-invalid"},re={class:"field"},de=o("label",{for:"prenom"},"Prénom",-1),ue={key:0,class:"p-invalid"},ce={class:"field"},me=o("label",{for:"adresse"},"Adresse",-1),pe={class:"field"},ve=o("label",{for:"numero_telephone"},"Téléphone",-1),fe={key:0,class:"p-invalid"},he={class:"field"},_e=o("label",{for:"sexe"},"Sexe",-1),ye={class:"flex align-items-center justify-content-center"},be=o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Ce={key:0},xe={class:"flex align-items-center justify-content-center"},ge=o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),we={key:0},De={__name:"Client",setup(ke){const d=j(),f=r(null),y=r(!1),b=r(!1),k=r(!1),l=r({}),C=r(null),P=r(null),S=r({}),u=r(!1);z(()=>{A()}),O(()=>{T()});const T=async()=>{try{const a=await w.get("http://127.0.0.1:8000/api/clients");f.value=a.data}catch(a){console.error("Error fetching clients:",a),d.add({severity:"error",summary:"Error",detail:"Failed to fetch clients",life:3e3})}},N=()=>{y.value=!1,u.value=!1},M=async()=>{if(u.value=!0,l.value.nom&&l.value.prenom&&l.value.numero_telephone)try{l.value.id?(await w.post(`http://127.0.0.1:8000/api/clients/${l.value.id}`,l.value),d.add({severity:"success",summary:"Successful",detail:"Client Updated",life:3e3})):(await w.post("http://127.0.0.1:8000/api/clients",l.value),d.add({severity:"success",summary:"Successful",detail:"Client Created",life:3e3})),y.value=!1,l.value={},await T()}catch(a){console.error("Error saving client:",a),d.add({severity:"error",summary:"Error",detail:"Failed to save client",life:3e3})}},U=a=>{l.value={...a},y.value=!0},E=a=>{l.value=a,b.value=!0},F=async()=>{try{await w.delete(`http://127.0.0.1:8000/api/clients/${l.value.id}`),f.value=f.value.filter(a=>a.id!==l.value.id),b.value=!1,l.value={},d.add({severity:"success",summary:"Successful",detail:"Client Deleted",life:3e3})}catch(a){console.error("Error deleting client:",a),d.add({severity:"error",summary:"Error",detail:"Failed to delete client",life:3e3})}},$=()=>{P.value.exportCSV()},q=async()=>{try{for(let a of C.value)await w.delete(`http://127.0.0.1:8000/api/clients/${a.id}`);f.value=f.value.filter(a=>!C.value.includes(a)),k.value=!1,C.value=null,d.add({severity:"success",summary:"Successful",detail:"Clients Deleted",life:3e3})}catch(a){console.error("Error deleting selected clients:",a),d.add({severity:"error",summary:"Error",detail:"Failed to delete selected clients",life:3e3})}},A=()=>{S.value={global:{value:null,matchMode:Y.CONTAINS}}};return(a,s)=>{const n=v("Button"),B=v("Toolbar"),x=v("InputText"),c=v("Column"),L=v("DataTable"),I=v("Dropdown"),V=v("Dialog");return h(),_("div",K,[o("div",G,[o("div",H,[t(B,{class:"mb-4"},{end:i(()=>[t(n,{label:"Export",icon:"pi pi-upload",severity:"help",onClick:s[0]||(s[0]=e=>$(e))})]),_:1}),t(L,{ref_key:"dt",ref:P,value:f.value,selection:C.value,"onUpdate:selection":s[2]||(s[2]=e=>C.value=e),dataKey:"id",paginator:!0,rows:10,filters:S.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} clients"},{header:i(()=>[o("div",J,[Q,o("span",W,[X,t(x,{modelValue:S.value.global.value,"onUpdate:modelValue":s[1]||(s[1]=e=>S.value.global.value=e),placeholder:"Search..."},null,8,["modelValue"])])])]),default:i(()=>[t(c,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(c,{field:"id",header:"ID",sortable:!0,headerStyle:"width:10%; min-width:8rem;"},{body:i(e=>[Z,m(" "+p(e.data.id),1)]),_:1}),t(c,{field:"nom",header:"Nom",sortable:!0,headerStyle:"width:15%; min-width:10rem;"},{body:i(e=>[ee,m(" "+p(e.data.nom),1)]),_:1}),t(c,{field:"prenom",header:"Prénom",sortable:!0,headerStyle:"width:15%; min-width:10rem;"},{body:i(e=>[le,m(" "+p(e.data.prenom),1)]),_:1}),t(c,{field:"adresse",header:"Adresse",sortable:!0,headerStyle:"width:20%; min-width:10rem;"},{body:i(e=>[te,m(" "+p(e.data.adresse),1)]),_:1}),t(c,{field:"numero_telephone",header:"Téléphone",sortable:!0,headerStyle:"width:15%; min-width:10rem;"},{body:i(e=>[oe,m(" "+p(e.data.numero_telephone),1)]),_:1}),t(c,{field:"sexe",header:"Sexe",sortable:!0,headerStyle:"width:10%; min-width:8rem;"},{body:i(e=>[se,m(" "+p(e.data.sexe),1)]),_:1}),t(c,{headerStyle:"min-width:10rem;"},{body:i(e=>[t(n,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:R=>U(e.data)},null,8,["onClick"]),t(n,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning",onClick:R=>E(e.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),t(V,{visible:y.value,"onUpdate:visible":s[8]||(s[8]=e=>y.value=e),style:{width:"450px"},header:"Client Details",modal:!0,class:"p-fluid"},{footer:i(()=>[t(n,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:N}),t(n,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:M})]),default:i(()=>[o("div",ae,[ie,t(x,{id:"nom",modelValue:l.value.nom,"onUpdate:modelValue":s[3]||(s[3]=e=>l.value.nom=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:D({"p-invalid":u.value&&!l.value.nom})},null,8,["modelValue","class"]),u.value&&!l.value.nom?(h(),_("small",ne,"Nom is required.")):g("",!0)]),o("div",re,[de,t(x,{id:"prenom",modelValue:l.value.prenom,"onUpdate:modelValue":s[4]||(s[4]=e=>l.value.prenom=e),modelModifiers:{trim:!0},required:"true",class:D({"p-invalid":u.value&&!l.value.prenom})},null,8,["modelValue","class"]),u.value&&!l.value.prenom?(h(),_("small",ue,"Prénom is required.")):g("",!0)]),o("div",ce,[me,t(x,{id:"adresse",modelValue:l.value.adresse,"onUpdate:modelValue":s[5]||(s[5]=e=>l.value.adresse=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),o("div",pe,[ve,t(x,{id:"numero_telephone",modelValue:l.value.numero_telephone,"onUpdate:modelValue":s[6]||(s[6]=e=>l.value.numero_telephone=e),modelModifiers:{trim:!0},required:"true",class:D({"p-invalid":u.value&&!l.value.numero_telephone})},null,8,["modelValue","class"]),u.value&&!l.value.numero_telephone?(h(),_("small",fe,"Téléphone is required.")):g("",!0)]),o("div",he,[_e,t(I,{id:"sexe",modelValue:l.value.sexe,"onUpdate:modelValue":s[7]||(s[7]=e=>l.value.sexe=e),options:["M","F"],placeholder:"Select Sex"},null,8,["modelValue"])])]),_:1},8,["visible"]),t(V,{visible:b.value,"onUpdate:visible":s[10]||(s[10]=e=>b.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[t(n,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[9]||(s[9]=e=>b.value=!1)}),t(n,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:F})]),default:i(()=>[o("div",ye,[be,l.value?(h(),_("span",Ce,[m("Are you sure you want to delete "),o("b",null,p(l.value.nom)+" "+p(l.value.prenom),1),m("?")])):g("",!0)])]),_:1},8,["visible"]),t(V,{visible:k.value,"onUpdate:visible":s[12]||(s[12]=e=>k.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:i(()=>[t(n,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[11]||(s[11]=e=>k.value=!1)}),t(n,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:q})]),default:i(()=>[o("div",xe,[ge,l.value?(h(),_("span",we,"Are you sure you want to delete the selected clients?")):g("",!0)])]),_:1},8,["visible"])])])])}}};export{De as default};
